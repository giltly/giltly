jQuery.extend({Enumerable:function(){var a=function(a){this.GetEnumerator=a};a.Choice=function(){var b=arguments[0]instanceof Array?arguments[0]:arguments;return new a(function(){return new c(d.Blank,function(){return this.Yield(b[Math.floor(Math.random()*b.length)])},d.Blank)})};a.Cycle=function(){var b=arguments[0]instanceof Array?arguments[0]:arguments;return new a(function(){var a=0;return new c(d.Blank,function(){if(a>=b.length)a=0;return this.Yield(b[a++])},d.Blank)})};a.Empty=function(){return new a(function(){return new c(d.Blank,function(){return false},d.Blank)})};a.From=function(g){if(g==null)return a.Empty();if(g instanceof a)return g;if(typeof g==f.Number||typeof g==f.Boolean)return a.Repeat(g,1);if(typeof g==f.String)return new a(function(){var a=0;return new c(d.Blank,function(){return a<g.length?this.Yield(g.charAt(a++)):false},d.Blank)});if(typeof g!=f.Function){if(typeof g.length==f.Number)return new e(g);if(!(g instanceof Object)&&b.IsIEnumerable(g))return new a(function(){var b=true,a;return new c(function(){a=new Enumerator(g)},function(){if(b)b=false;else a.moveNext();return a.atEnd()?false:this.Yield(a.item())},d.Blank)})}return new a(function(){var a=[],b=0;return new c(function(){for(var b in g)!(g[b]instanceof Function)&&a.push({Key:b,Value:g[b]})},function(){return b<a.length?this.Yield(a[b++]):false},d.Blank)})},a.Return=function(b){return a.Repeat(b,1)};a.Matches=function(f,e,b){if(b==null)b="";if(e instanceof RegExp){b+=e.ignoreCase?"i":"";b+=e.multiline?"m":"";e=e.source}if(b.indexOf("g")===-1)b+="g";return new a(function(){var a;return new c(function(){a=new RegExp(e,b)},function(){var b=a.exec(f);return b?this.Yield(b):false},d.Blank)})};a.Range=function(d,c,b){if(b==null)b=1;return a.ToInfinity(d,b).Take(c)};a.RangeDown=function(d,c,b){if(b==null)b=1;return a.ToNegativeInfinity(d,b).Take(c)};a.RangeTo=function(c,d,b){if(b==null)b=1;return c<d?a.ToInfinity(c,b).TakeWhile(function(a){return a<=d}):a.ToNegativeInfinity(c,b).TakeWhile(function(a){return a>=d})};a.Repeat=function(e,b){return b!=null?a.Repeat(e).Take(b):new a(function(){return new c(d.Blank,function(){return this.Yield(e)},d.Blank)})};a.RepeatWithFinalize=function(d,e){d=b.CreateLambda(d);e=b.CreateLambda(e);return new a(function(){var a;return new c(function(){a=d()},function(){return this.Yield(a)},function(){if(a!=null){e(a);a=null}})})};a.Generate=function(e,f){if(f!=null)return a.Generate(e).Take(f);e=b.CreateLambda(e);return new a(function(){return new c(d.Blank,function(){return this.Yield(e())},d.Blank)})};a.ToInfinity=function(e,b){if(e==null)e=0;if(b==null)b=1;return new a(function(){var a;return new c(function(){a=e-b},function(){return this.Yield(a+=b)},d.Blank)})};a.ToNegativeInfinity=function(e,b){if(e==null)e=0;if(b==null)b=1;return new a(function(){var a;return new c(function(){a=e+b},function(){return this.Yield(a-=b)},d.Blank)})};a.Unfold=function(f,e){e=b.CreateLambda(e);return new a(function(){var b=true,a;return new c(d.Blank,function(){if(b){b=false;a=f;return this.Yield(a)}a=e(a);return this.Yield(a)},d.Blank)})};a.prototype={CascadeBreadthFirst:function(e,d){var f=this;e=b.CreateLambda(e);d=b.CreateLambda(d);return new a(function(){var g,i=0,h=[];return new c(function(){g=f.GetEnumerator()},function(){while(true){if(g.MoveNext()){h.push(g.Current());return this.Yield(d(g.Current(),i))}var c=a.From(h).SelectMany(function(a){return e(a)});if(!c.Any())return false;else{i++;h=[];b.Dispose(g);g=c.GetEnumerator()}}},function(){b.Dispose(g)})})},CascadeDepthFirst:function(e,d){var f=this;e=b.CreateLambda(e);d=b.CreateLambda(d);return new a(function(){var h=[],g;return new c(function(){g=f.GetEnumerator()},function(){while(true){if(g.MoveNext()){var c=d(g.Current(),h.length);h.push(g);g=a.From(e(g.Current())).GetEnumerator();return this.Yield(c)}if(h.length<=0)return false;b.Dispose(g);g=h.pop()}},function(){try{b.Dispose(g)}finally{a.From(h).ForEach(function(a){a.Dispose()})}})})},Flatten:function(){var e=this;return new a(function(){var g,f=null;return new c(function(){g=e.GetEnumerator()},function(){while(true){if(f!=null)if(f.MoveNext())return this.Yield(f.Current());else f=null;if(g.MoveNext())if(g.Current()instanceof Array){b.Dispose(f);f=a.From(g.Current()).SelectMany(d.Identity).Flatten().GetEnumerator();continue}else return this.Yield(g.Current());return false}},function(){try{b.Dispose(g)}finally{b.Dispose(f)}})})},Pairwise:function(d){var e=this;d=b.CreateLambda(d);return new a(function(){var a;return new c(function(){a=e.GetEnumerator();a.MoveNext()},function(){var b=a.Current();return a.MoveNext()?this.Yield(d(b,a.Current())):false},function(){b.Dispose(a)})})},Scan:function(f,d,g){if(g!=null)return this.Scan(f,d).Select(g);var e;if(d==null){d=b.CreateLambda(f);e=false}else{d=b.CreateLambda(d);e=true}var h=this;return new a(function(){var a,g,i=true;return new c(function(){a=h.GetEnumerator()},function(){if(i){i=false;if(!e){if(a.MoveNext())return this.Yield(g=a.Current())}else return this.Yield(g=f)}return a.MoveNext()?this.Yield(g=d(g,a.Current())):false},function(){b.Dispose(a)})})},Select:function(d){var e=this;d=b.CreateLambda(d);return new a(function(){var a,f=0;return new c(function(){a=e.GetEnumerator()},function(){return a.MoveNext()?this.Yield(d(a.Current(),f++)):false},function(){b.Dispose(a)})})},SelectMany:function(e,d){var f=this;e=b.CreateLambda(e);if(d==null)d=function(b,a){return a};d=b.CreateLambda(d);return new a(function(){var h,g=undefined,i=0;return new c(function(){h=f.GetEnumerator()},function(){if(g===undefined)if(!h.MoveNext())return false;do{if(g==null){var c=e(h.Current(),i++);g=a.From(c).GetEnumerator()}if(g.MoveNext())return this.Yield(d(h.Current(),g.Current()));b.Dispose(g);g=null}while(h.MoveNext());return false},function(){try{b.Dispose(h)}finally{b.Dispose(g)}})})},Where:function(d){d=b.CreateLambda(d);var e=this;return new a(function(){var a,f=0;return new c(function(){a=e.GetEnumerator()},function(){while(a.MoveNext())if(d(a.Current(),f++))return this.Yield(a.Current());return false},function(){b.Dispose(a)})})},OfType:function(b){var a;switch(b){case Number:a=f.Number;break;case String:a=f.String;break;case Boolean:a=f.Boolean;break;case Function:a=f.Function;break;default:a=null}return a===null?this.Where(function(a){return a instanceof b}):this.Where(function(b){return typeof b===a})},Zip:function(e,d){d=b.CreateLambda(d);var f=this;return new a(function(){var h,g,i=0;return new c(function(){h=f.GetEnumerator();g=a.From(e).GetEnumerator()},function(){return h.MoveNext()&&g.MoveNext()?this.Yield(d(h.Current(),g.Current(),i++)):false},function(){try{b.Dispose(h)}finally{b.Dispose(g)}})})},Join:function(j,f,e,h,g){f=b.CreateLambda(f);e=b.CreateLambda(e);h=b.CreateLambda(h);g=b.CreateLambda(g);var i=this;return new a(function(){var k,n,l=null,m=0;return new c(function(){k=i.GetEnumerator();n=a.From(j).ToLookup(e,d.Identity,g)},function(){while(true){if(l!=null){var a=l[m++];if(a!==undefined)return this.Yield(h(k.Current(),a));a=null;m=0}if(k.MoveNext()){var b=f(k.Current());l=n.Get(b).ToArray()}else return false}},function(){b.Dispose(k)})})},GroupJoin:function(j,f,e,h,g){f=b.CreateLambda(f);e=b.CreateLambda(e);h=b.CreateLambda(h);g=b.CreateLambda(g);var i=this;return new a(function(){var k=i.GetEnumerator(),l=null;return new c(function(){k=i.GetEnumerator();l=a.From(j).ToLookup(e,d.Identity,g)},function(){if(k.MoveNext()){var a=l.Get(f(k.Current()));return this.Yield(h(k.Current(),a))}return false},function(){b.Dispose(k)})})},All:function(a){a=b.CreateLambda(a);var c=true;this.ForEach(function(b){if(!a(b)){c=false;return false}});return c},Any:function(c){c=b.CreateLambda(c);var a=this.GetEnumerator();try{if(arguments.length==0)return a.MoveNext();while(a.MoveNext())if(c(a.Current()))return true;return false}finally{b.Dispose(a)}},Concat:function(d){var e=this;return new a(function(){var g,f;return new c(function(){g=e.GetEnumerator()},function(){if(f==null){if(g.MoveNext())return this.Yield(g.Current());f=a.From(d).GetEnumerator()}return f.MoveNext()?this.Yield(f.Current()):false},function(){try{b.Dispose(g)}finally{b.Dispose(f)}})})},Insert:function(f,d){var e=this;return new a(function(){var h,g,j=0,i=false;return new c(function(){h=e.GetEnumerator();g=a.From(d).GetEnumerator()},function(){if(j==f&&g.MoveNext()){i=true;return this.Yield(g.Current())}if(h.MoveNext()){j++;return this.Yield(h.Current())}return!i&&g.MoveNext()?this.Yield(g.Current()):false},function(){try{b.Dispose(h)}finally{b.Dispose(g)}})})},Alternate:function(b){b=a.Return(b);return this.SelectMany(function(c){return a.Return(c).Concat(b)}).TakeExceptLast()},Contains:function(d,a){a=b.CreateLambda(a);var c=this.GetEnumerator();try{while(c.MoveNext())if(a(c.Current())===d)return true;return false}finally{b.Dispose(c)}},DefaultIfEmpty:function(d){var e=this;return new a(function(){var a,f=true;return new c(function(){a=e.GetEnumerator()},function(){if(a.MoveNext()){f=false;return this.Yield(a.Current())}else if(f){f=false;return this.Yield(d)}return false},function(){b.Dispose(a)})})},Distinct:function(b){return this.Except(a.Empty(),b)},Except:function(e,d){d=b.CreateLambda(d);var f=this;return new a(function(){var g,h;return new c(function(){g=f.GetEnumerator();h=new j(d);a.From(e).ForEach(function(a){h.Add(a)})},function(){while(g.MoveNext()){var a=g.Current();if(!h.Contains(a)){h.Add(a);return this.Yield(a)}}return false},function(){b.Dispose(g)})})},Intersect:function(e,d){d=b.CreateLambda(d);var f=this;return new a(function(){var g,h,i;return new c(function(){g=f.GetEnumerator();h=new j(d);a.From(e).ForEach(function(a){h.Add(a)});i=new j(d)},function(){while(g.MoveNext()){var a=g.Current();if(!i.Contains(a)&&h.Contains(a)){i.Add(a);return this.Yield(a)}}return false},function(){b.Dispose(g)})})},SequenceEqual:function(f,d){d=b.CreateLambda(d);var e=this.GetEnumerator();try{var c=a.From(f).GetEnumerator();try{while(e.MoveNext())if(!c.MoveNext()||d(e.Current())!==d(c.Current()))return false;return c.MoveNext()?false:true}finally{b.Dispose(c)}}finally{b.Dispose(e)}},Union:function(e,d){d=b.CreateLambda(d);var f=this;return new a(function(){var i,g,h;return new c(function(){i=f.GetEnumerator();h=new j(d)},function(){var b;if(g===undefined){while(i.MoveNext()){b=i.Current();if(!h.Contains(b)){h.Add(b);return this.Yield(b)}}g=a.From(e).GetEnumerator()}while(g.MoveNext()){b=g.Current();if(!h.Contains(b)){h.Add(b);return this.Yield(b)}}return false},function(){try{b.Dispose(i)}finally{b.Dispose(g)}})})},OrderBy:function(a){return new g(this,a,false)},OrderByDescending:function(a){return new g(this,a,true)},Reverse:function(){var b=this;return new a(function(){var a,e;return new c(function(){a=b.ToArray();e=a.length},function(){return e>0?this.Yield(a[--e]):false},d.Blank)})},Shuffle:function(){var b=this;return new a(function(){var a;return new c(function(){a=b.ToArray()},function(){if(a.length>0){var b=Math.floor(Math.random()*a.length);return this.Yield(a.splice(b,1)[0])}return false},d.Blank)})},GroupBy:function(g,f,d,e){var h=this;g=b.CreateLambda(g);f=b.CreateLambda(f);if(d!=null)d=b.CreateLambda(d);e=b.CreateLambda(e);return new a(function(){var a;return new c(function(){a=h.ToLookup(g,f,e).ToEnumerable().GetEnumerator()},function(){while(a.MoveNext())return d==null?this.Yield(a.Current()):this.Yield(d(a.Current().Key(),a.Current()));return false},function(){b.Dispose(a)})})},PartitionBy:function(g,f,d,e){var i=this;g=b.CreateLambda(g);f=b.CreateLambda(f);e=b.CreateLambda(e);var h;if(d==null){h=false;d=function(b,a){return new k(b,a)}}else{h=true;d=b.CreateLambda(d)}return new a(function(){var j,l,m,k=[];return new c(function(){j=i.GetEnumerator();if(j.MoveNext()){l=g(j.Current());m=e(l);k.push(f(j.Current()))}},function(){var b;while((b=j.MoveNext())==true)if(m===e(g(j.Current())))k.push(f(j.Current()));else break;if(k.length>0){var c=h?d(l,a.From(k)):d(l,k);if(b){l=g(j.Current());m=e(l);k=[f(j.Current())]}else k=[];return this.Yield(c)}return false},function(){b.Dispose(j)})})},BufferWithCount:function(e){var d=this;return new a(function(){var a;return new c(function(){a=d.GetEnumerator()},function(){var b=[],c=0;while(a.MoveNext()){b.push(a.Current());if(++c>=e)return this.Yield(b)}return b.length>0?this.Yield(b):false},function(){b.Dispose(a)})})},Aggregate:function(c,b,a){return this.Scan(c,b,a).Last()},Average:function(a){a=b.CreateLambda(a);var d=0,c=0;this.ForEach(function(b){d+=a(b);++c});return d/c},Count:function(a){a=a==null?d.True:b.CreateLambda(a);var c=0;this.ForEach(function(d,b){if(a(d,b))++c});return c},Max:function(a){if(a==null)a=d.Identity;return this.Select(a).Aggregate(function(a,b){return a>b?a:b})},Min:function(a){if(a==null)a=d.Identity;return this.Select(a).Aggregate(function(a,b){return a<b?a:b})},MaxBy:function(a){a=b.CreateLambda(a);return this.Aggregate(function(b,c){return a(b)>a(c)?b:c})},MinBy:function(a){a=b.CreateLambda(a);return this.Aggregate(function(b,c){return a(b)<a(c)?b:c})},Sum:function(a){if(a==null)a=d.Identity;return this.Select(a).Aggregate(0,function(a,b){return a+b})},ElementAt:function(c){var b,a=false;this.ForEach(function(e,d){if(d==c){b=e;a=true;return false}});if(!a)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return b},ElementAtOrDefault:function(d,c){var b,a=false;this.ForEach(function(e,c){if(c==d){b=e;a=true;return false}});return!a?c:b},First:function(a){if(a!=null)return this.Where(a).First();var c,b=false;this.ForEach(function(a){c=a;b=true;return false});if(!b)throw new Error("First:No element satisfies the condition.");return c},FirstOrDefault:function(a,b){if(b!=null)return this.Where(b).FirstOrDefault(a);var d,c=false;this.ForEach(function(a){d=a;c=true;return false});return!c?a:d},Last:function(a){if(a!=null)return this.Where(a).Last();var c,b=false;this.ForEach(function(a){b=true;c=a});if(!b)throw new Error("Last:No element satisfies the condition.");return c},LastOrDefault:function(a,b){if(b!=null)return this.Where(b).LastOrDefault(a);var d,c=false;this.ForEach(function(a){c=true;d=a});return!c?a:d},Single:function(b){if(b!=null)return this.Where(b).Single();var c,a=false;this.ForEach(function(b){if(!a){a=true;c=b}else throw new Error("Single:sequence contains more than one element.");});if(!a)throw new Error("Single:No element satisfies the condition.");return c},SingleOrDefault:function(b,c){if(c!=null)return this.Where(c).SingleOrDefault(b);var d,a=false;this.ForEach(function(b){if(!a){a=true;d=b}else throw new Error("Single:sequence contains more than one element.");});return!a?b:d},Skip:function(e){var d=this;return new a(function(){var a,f=0;return new c(function(){a=d.GetEnumerator();while(f++<e&&a.MoveNext());},function(){return a.MoveNext()?this.Yield(a.Current()):false},function(){b.Dispose(a)})})},SkipWhile:function(d){d=b.CreateLambda(d);var e=this;return new a(function(){var a,g=0,f=false;return new c(function(){a=e.GetEnumerator()},function(){while(!f)if(a.MoveNext()){if(!d(a.Current(),g++)){f=true;return this.Yield(a.Current())}continue}else return false;return a.MoveNext()?this.Yield(a.Current()):false},function(){b.Dispose(a)})})},Take:function(e){var d=this;return new a(function(){var a,f=0;return new c(function(){a=d.GetEnumerator()},function(){return f++<e&&a.MoveNext()?this.Yield(a.Current()):false},function(){b.Dispose(a)})})},TakeWhile:function(d){d=b.CreateLambda(d);var e=this;return new a(function(){var a,f=0;return new c(function(){a=e.GetEnumerator()},function(){return a.MoveNext()&&d(a.Current(),f++)?this.Yield(a.Current()):false},function(){b.Dispose(a)})})},TakeExceptLast:function(d){if(d==null)d=1;var e=this;return new a(function(){if(d<=0)return e.GetEnumerator();var a,f=[];return new c(function(){a=e.GetEnumerator()},function(){while(a.MoveNext()){if(f.length==d){f.push(a.Current());return this.Yield(f.shift())}f.push(a.Current())}return false},function(){b.Dispose(a)})})},TakeFromLast:function(d){if(d<=0||d==null)return a.Empty();var e=this;return new a(function(){var h,f,g=[];return new c(function(){h=e.GetEnumerator()},function(){while(h.MoveNext()){g.length==d&&g.shift();g.push(h.Current())}if(f==null)f=a.From(g).GetEnumerator();return f.MoveNext()?this.Yield(f.Current()):false},function(){b.Dispose(f)})})},IndexOf:function(b){var a=null;this.ForEach(function(d,c){if(d===b){a=c;return true}});return a!==null?a:-1},LastIndexOf:function(b){var a=-1;this.ForEach(function(d,c){if(d===b)a=c});return a},ToArray:function(){var a=[];this.ForEach(function(b){a.push(b)});return a},ToLookup:function(d,c,a){d=b.CreateLambda(d);c=b.CreateLambda(c);a=b.CreateLambda(a);var e=new j(a);this.ForEach(function(g){var f=d(g),a=c(g),b=e.Get(f);if(b!==undefined)b.push(a);else e.Add(f,[a])});return new m(e)},ToObject:function(c,a){c=b.CreateLambda(c);a=b.CreateLambda(a);var d={};this.ForEach(function(b){d[c(b)]=a(b)});return d},ToDictionary:function(d,c,a){d=b.CreateLambda(d);c=b.CreateLambda(c);a=b.CreateLambda(a);var e=new j(a);this.ForEach(function(a){e.Add(d(a),c(a))});return e},ToJSON:function(a,b){return JSON.stringify(this.ToArray(),a,b)},ToString:function(a,b){if(a==null)a="";if(b==null)b=d.Identity;return this.Select(b).ToArray().join(a)},Do:function(d){var e=this;d=b.CreateLambda(d);return new a(function(){var a,f=0;return new c(function(){a=e.GetEnumerator()},function(){if(a.MoveNext()){d(a.Current(),f++);return this.Yield(a.Current())}return false},function(){b.Dispose(a)})})},ForEach:function(c){c=b.CreateLambda(c);var d=0,a=this.GetEnumerator();try{while(a.MoveNext())if(c(a.Current(),d++)===false)break}finally{b.Dispose(a)}},Write:function(a,c){if(a==null)a="";c=b.CreateLambda(c);var d=true;this.ForEach(function(b){if(d)d=false;else document.write(a);document.write(c(b))})},WriteLine:function(a){a=b.CreateLambda(a);this.ForEach(function(b){document.write(a(b));document.write("<br />")})},Force:function(){var a=this.GetEnumerator();try{while(a.MoveNext());}finally{b.Dispose(a)}},Let:function(d){d=b.CreateLambda(d);var e=this;return new a(function(){var f;return new c(function(){f=a.From(d(e)).GetEnumerator()},function(){return f.MoveNext()?this.Yield(f.Current()):false},function(){b.Dispose(f)})})},Share:function(){var e=this,b;return new a(function(){return new c(function(){if(b==null)b=e.GetEnumerator()},function(){return b.MoveNext()?this.Yield(b.Current()):false},d.Blank)})},MemoizeAll:function(){var f=this,e,b;return new a(function(){var a=-1;return new c(function(){if(b==null){b=f.GetEnumerator();e=[]}},function(){a++;return e.length<=a?b.MoveNext()?this.Yield(e[a]=b.Current()):false:this.Yield(e[a])},d.Blank)})},Catch:function(d){d=b.CreateLambda(d);var e=this;return new a(function(){var a;return new c(function(){a=e.GetEnumerator()},function(){try{return a.MoveNext()?this.Yield(a.Current()):false}catch(b){d(b);return false}},function(){b.Dispose(a)})})},Finally:function(d){d=b.CreateLambda(d);var e=this;return new a(function(){var a;return new c(function(){a=e.GetEnumerator()},function(){return a.MoveNext()?this.Yield(a.Current()):false},function(){try{b.Dispose(a)}finally{d()}})})},Trace:function(c,a){if(c==null)c="Trace";a=b.CreateLambda(a);return this.Do(function(b){console.log(c,":",a(b))})}};var d={Identity:function(a){return a},True:function(){return true},Blank:function(){}},f={Boolean:typeof true,Number:typeof 0,String:typeof"",Object:typeof{},Undefined:typeof undefined,Function:typeof function(){}},b={CreateLambda:function(a){if(a==null)return d.Identity;if(typeof a==f.String)if(a=="")return d.Identity;else if(a.indexOf("=>")==-1)return new Function("$,$$,$$$,$$$$","return "+a);else{var b=a.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return new Function(b[1],"return "+b[2])}return a},IsIEnumerable:function(a){if(typeof Enumerator!=f.Undefined)try{new Enumerator(a);return true}catch(b){}return false},Compare:function(a,b){return a===b?0:a>b?1:-1},Dispose:function(a){a!=null&&a.Dispose()}},h={Before:0,Running:1,After:2},c=function(c,d,e){var b=new l,a=h.Before;this.Current=b.Current;this.MoveNext=function(){try{switch(a){case h.Before:a=h.Running;c();case h.Running:if(d.apply(b))return true;else{this.Dispose();return false}case h.After:return false}}catch(e){this.Dispose();throw e;}};this.Dispose=function(){if(a!=h.Running)return;try{e()}finally{a=h.After}}},l=function(){var a=null;this.Current=function(){return a};this.Yield=function(b){a=b;return true}},g=function(e,a,c,d){this.source=e;this.keySelector=b.CreateLambda(a);this.descending=c;this.parent=d};g.prototype=new a;g.prototype.CreateOrderedEnumerable=function(a,b){return new g(this.source,a,b,this)};g.prototype.ThenBy=function(a){return this.CreateOrderedEnumerable(a,false)};g.prototype.ThenByDescending=function(a){return this.CreateOrderedEnumerable(a,true)};g.prototype.GetEnumerator=function(){var f=this,b,a,e=0;return new c(function(){b=[];a=[];f.source.ForEach(function(d,c){b.push(d);a.push(c)});var c=i.Create(f,null);c.GenerateKeys(b);a.sort(function(a,b){return c.Compare(a,b)})},function(){return e<a.length?this.Yield(b[a[e++]]):false},d.Blank)};var i=function(a,b,c){this.keySelector=a;this.descending=b;this.child=c;this.keys=null};i.Create=function(a,c){var b=new i(a.keySelector,a.descending,c);return a.parent!=null?i.Create(a.parent,b):b};i.prototype.GenerateKeys=function(b){for(var d=b.length,e=this.keySelector,c=new Array(d),a=0;a<d;a++)c[a]=e(b[a]);this.keys=c;this.child!=null&&this.child.GenerateKeys(b)};i.prototype.Compare=function(c,d){var a=b.Compare(this.keys[c],this.keys[d]);if(a==0){if(this.child!=null)return this.child.Compare(c,d);a=b.Compare(c,d)}return this.descending?-a:a};var e=function(a){this.source=a};e.prototype=new a;e.prototype.Any=function(b){return b==null?this.source.length>0:a.prototype.Any.apply(this,arguments)};e.prototype.Count=function(b){return b==null?this.source.length:a.prototype.Count.apply(this,arguments)};e.prototype.ElementAt=function(b){return 0<=b&&b<this.source.length?this.source[b]:a.prototype.ElementAt.apply(this,arguments)};e.prototype.ElementAtOrDefault=function(a,b){return 0<=a&&a<this.source.length?this.source[a]:b};e.prototype.First=function(b){return b==null&&this.source.length>0?this.source[0]:a.prototype.First.apply(this,arguments)};e.prototype.FirstOrDefault=function(b,c){return c!=null?a.prototype.FirstOrDefault.apply(this,arguments):this.source.length>0?this.source[0]:b};e.prototype.Last=function(b){return b==null&&this.source.length>0?this.source[this.source.length-1]:a.prototype.Last.apply(this,arguments)};e.prototype.LastOrDefault=function(b,c){return c!=null?a.prototype.LastOrDefault.apply(this,arguments):this.source.length>0?this.source[this.source.length-1]:b};e.prototype.Skip=function(e){var b=this.source;return new a(function(){var a;return new c(function(){a=e<0?0:e},function(){return a<b.length?this.Yield(b[a++]):false},d.Blank)})};e.prototype.TakeExceptLast=function(a){if(a==null)a=1;return this.Take(this.source.length-a)};e.prototype.TakeFromLast=function(a){return this.Skip(this.source.length-a)};e.prototype.Reverse=function(){var b=this.source;return new a(function(){var a;return new c(function(){a=b.length},function(){return a>0?this.Yield(b[--a]):false},d.Blank)})};e.prototype.SequenceEqual=function(b,c){return(b instanceof e||b instanceof Array)&&c==null&&a.From(b).Count()!=this.Count()?false:a.prototype.SequenceEqual.apply(this,arguments)};e.prototype.ToString=function(b,c){if(c!=null||!(this.source instanceof Array))return a.prototype.ToString.apply(this,arguments);if(b==null)b="";return this.source.join(b)};e.prototype.GetEnumerator=function(){var a=this.source,b=0;return new c(d.Blank,function(){return b<a.length?this.Yield(a[b++]):false},d.Blank)};var j=function(){var e=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b=function(a){return a===null?"null":a===undefined?"undefined":typeof a.toString===f.Function?a.toString():Object.prototype.toString.call(a)},i=function(b,a){this.Key=b;this.Value=a;this.Prev=null;this.Next=null},g=function(){this.First=null;this.Last=null};g.prototype={AddLast:function(a){if(this.Last!=null){this.Last.Next=a;a.Prev=this.Last;this.Last=a}else this.First=this.Last=a},Replace:function(b,a){if(b.Prev!=null){b.Prev.Next=a;a.Prev=b.Prev}else this.First=a;if(b.Next!=null){b.Next.Prev=a;a.Next=b.Next}else this.Last=a},Remove:function(a){if(a.Prev!=null)a.Prev.Next=a.Next;else this.First=a.Next;if(a.Next!=null)a.Next.Prev=a.Prev;else this.Last=a.Prev}};var h=function(a){this.count=0;this.entryList=new g;this.buckets={};this.compareSelector=a==null?d.Identity:a};h.prototype={Add:function(h,j){var g=this.compareSelector(h),f=b(g),c=new i(h,j);if(e(this.buckets,f)){for(var a=this.buckets[f],d=0;d<a.length;d++)if(this.compareSelector(a[d].Key)===g){this.entryList.Replace(a[d],c);a[d]=c;return}a.push(c)}else this.buckets[f]=[c];this.count++;this.entryList.AddLast(c)},Get:function(h){var c=this.compareSelector(h),g=b(c);if(!e(this.buckets,g))return undefined;for(var d=this.buckets[g],a=0;a<d.length;a++){var f=d[a];if(this.compareSelector(f.Key)===c)return f.Value}return undefined},Set:function(h,j){var d=this.compareSelector(h),g=b(d);if(e(this.buckets,g))for(var c=this.buckets[g],a=0;a<c.length;a++)if(this.compareSelector(c[a].Key)===d){var f=new i(h,j);this.entryList.Replace(c[a],f);c[a]=f;return true}return false},Contains:function(g){var c=this.compareSelector(g),f=b(c);if(!e(this.buckets,f))return false;for(var d=this.buckets[f],a=0;a<d.length;a++)if(this.compareSelector(d[a].Key)===c)return true;return false},Clear:function(){this.count=0;this.buckets={};this.entryList=new g},Remove:function(g){var f=this.compareSelector(g),d=b(f);if(!e(this.buckets,d))return;for(var a=this.buckets[d],c=0;c<a.length;c++)if(this.compareSelector(a[c].Key)===f){this.entryList.Remove(a[c]);a.splice(c,1);if(a.length==0)delete this.buckets[d];this.count--;return}},Count:function(){return this.count},ToEnumerable:function(){var b=this;return new a(function(){var a;return new c(function(){a=b.entryList.First},function(){if(a!=null){var b={Key:a.Key,Value:a.Value};a=a.Next;return this.Yield(b)}return false},d.Blank)})}};return h}(),m=function(b){this.Count=function(){return b.Count()};this.Get=function(c){return a.From(b.Get(c))};this.Contains=function(a){return b.Contains(a)};this.ToEnumerable=function(){return b.ToEnumerable().Select(function(a){return new k(a.Key,a.Value)})}},k=function(b,a){this.Key=function(){return b};e.call(this,a)};k.prototype=new e;return a}()});(function(a,b){a.fn.toEnumerable=function(){return b.From(this).Select(function(b){return a(b)})};b.prototype.TojQuery=function(){return a(this.ToArray())}})(jQuery,this.Enumerable||this.jQuery.Enumerable);