(function(a){a.widget("metro.slider",{version:"1.0.0",options:{position:0,accuracy:0,color:"default",completeColor:"default",markerColor:"default",colors:[],showHint:false,change:function(){},changed:function(){},_slider:{vertical:false,offset:0,length:0,marker:0,ppp:0,start:0,stop:0}},_create:function(){var c=this,a=this.element,b=this.options,d=this.options._slider;if(a.data("accuracy")!=undefined)b.accuracy=a.data("accuracy")>0?a.data("accuracy"):0;if(a.data("position")!=undefined)b.position=this._correctValue(a.data("position")>0?a.data("position")>100?100:a.data("position"):0);if(a.data("color")!=undefined)b.color=a.data("color");if(a.data("completeColor")!=undefined)b.completeColor=a.data("completeColor");if(a.data("markerColor")!=undefined)b.markerColor=a.data("markerColor");if(a.data("colors")!=undefined)b.colors=a.data("colors").split(",");if(a.data("showHint")!=undefined)b.showHint=a.data("showHint");d.vertical=a.hasClass("vertical");this._createSlider();this._initPoints();this._placeMarker(b.position);addTouchEvents(a[0]);a.children(".marker").on("mousedown",function(a){a.preventDefault();c._startMoveMarker(a)});a.on("mousedown",function(a){a.preventDefault();c._startMoveMarker(a)})},_startMoveMarker:function(e){var b=this.element,f=this.options,c=this,d=b.children(".hint");a(b).on("mousemove",function(a){c._movingMarker(a);!b.hasClass("permanent-hint")&&d.css("display","block")});a(b).on("mouseup",function(){a(b).off("mousemove");b.off("mouseup");b.data("value",c.options.position);b.trigger("changed",c.options.position);f.changed(c.options.position,b);!b.hasClass("permanent-hint")&&d.css("display","none")});this._initPoints();this._movingMarker(e)},_movingMarker:function(i){var a,b,c,h=this.options._slider.vertical,d=this.options._slider.offset,e=this.options._slider.start,g=this.options._slider.stop,j=this.options._slider.length,f=this.options._slider.marker;if(h)a=i.pageY-d;else a=i.pageX-d;if(a<e)a=e;else if(a>g)a=g;if(h)c=j-a-f/2;else c=a-f/2;b=this._pixToPerc(c);this._placeMarker(b);this.options.position=b;this.options.change(Math.round(b),this.element)},_placeMarker:function(f){var a,i,c=this.options,d=0,b=0,h=0,j=this.element.children(".marker"),e=this.element.children(".complete"),g=this.element.children(".hint");d=c.colors.length;h=c._slider.length/d;if(this.options._slider.vertical){a=this._percToPix(f)+this.options._slider.marker;i=this.options._slider.length-a;j.css("top",i);e.css("height",a);if(d){b=Math.round(a/h)-1;e.css("background-color",c.colors[b<0?0:b])}c.showHint&&g.html(Math.round(f)).css("top",i-g.height()/2)}else{a=this._percToPix(f);j.css("left",a);e.css("width",a);if(d){b=Math.round(a/h)-1;e.css("background-color",c.colors[b<0?0:b])}c.showHint&&g.html(Math.round(f)).css("left",a-g.width()/2)}},_pixToPerc:function(b){var a;a=b*this.options._slider.ppp;return this._correctValue(a)},_percToPix:function(a){return this.options._slider.ppp===0?0:a/this.options._slider.ppp},_correctValue:function(a){var b=this.options.accuracy;if(b===0)return a;if(a===100)return 100;a=Math.floor(a/b)*b+Math.round(a%b/b)*b;return a>100?100:a},_initPoints:function(){var a=this.options._slider,b=this.element;if(a.vertical){a.offset=b.offset().top;a.length=b.height();a.marker=b.children(".marker").height()}else{a.offset=b.offset().left;a.length=b.width();a.marker=b.children(".marker").width()}a.ppp=100/(a.length-a.marker);a.start=a.marker/2;a.stop=a.length-a.marker/2},_createSlider:function(){var c=this.element,b=this.options,d,e,f;c.html("");d=a("<div/>").addClass("complete").appendTo(c);e=a("<a/>").addClass("marker").appendTo(c);if(b.showHint)f=a("<span/>").addClass("hint").appendTo(c);b.color!="default"&&c.css("background-color",b.color);b.completeColor!="default"&&d.css("background-color",b.completeColor);b.markerColor!="default"&&e.css("background-color",b.markerColor)},_destroy:function(){},_setOption:function(b,a){this._super("_setOption",b,a)}})})(jQuery);$(function(){$("[data-role=slider]").slider()});