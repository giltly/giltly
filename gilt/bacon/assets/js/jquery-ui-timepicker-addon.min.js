/* jQuery Timepicker Addon - v1.4 - 2013-08-11
* http://trentrichardson.com/examples/timepicker
* Copyright (c) 2013 Trent Richardson; Licensed MIT */
(function(a){a.ui.timepicker=a.ui.timepicker||{};if(a.ui.timepicker.version)return;a.extend(a.ui,{timepicker:{version:"1.4"}});var g=function(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:false};this._defaults={showButtonPanel:true,timeOnly:false,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:true,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:true,separator:" ",altFieldTimeOnly:true,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:true,timezoneList:null,addSliderAccess:false,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"};a.extend(this._defaults,this.regional[""])};a.extend(g.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(a){c(this._defaults,a||{});return this},_newInst:function(c,n){var b=new g,k={},o={},e,j;for(var f in this._defaults)if(this._defaults.hasOwnProperty(f)){var l=c.attr("time:"+f);if(l)try{k[f]=eval(l)}catch(q){k[f]=l}}e={beforeShow:function(e,d){if(a.isFunction(b._defaults.evnts.beforeShow))return b._defaults.evnts.beforeShow.call(c[0],e,d,b)},onChangeMonthYear:function(f,e,d){b._updateDateTime(d);a.isFunction(b._defaults.evnts.onChangeMonthYear)&&b._defaults.evnts.onChangeMonthYear.call(c[0],f,e,d,b)},onClose:function(e,d){b.timeDefined===true&&c.val()!==""&&b._updateDateTime(d);a.isFunction(b._defaults.evnts.onClose)&&b._defaults.evnts.onClose.call(c[0],e,d,b)}};for(j in e)if(e.hasOwnProperty(j))o[j]=n[j]||null;b._defaults=a.extend({},this._defaults,k,n,e,{evnts:o,timepicker:b});b.amNames=a.map(b._defaults.amNames,function(a){return a.toUpperCase()});b.pmNames=a.map(b._defaults.pmNames,function(a){return a.toUpperCase()});b.support=h(b._defaults.timeFormat+(b._defaults.pickerTimeFormat?b._defaults.pickerTimeFormat:"")+(b._defaults.altTimeFormat?b._defaults.altTimeFormat:""));if(typeof b._defaults.controlType==="string"){if(b._defaults.controlType==="slider"&&typeof a.ui.slider==="undefined")b._defaults.controlType="select";b.control=b._controls[b._defaults.controlType]}else b.control=b._defaults.controlType;var d=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];if(b._defaults.timezoneList!==null)d=b._defaults.timezoneList;var p=d.length,i=0,m=null;if(p>0&&typeof d[0]!=="object")for(;i<p;i++){m=d[i];d[i]={value:m,label:a.timepicker.timezoneOffsetString(m,b.support.iso8601)}}b._defaults.timezoneList=d;b.timezone=b._defaults.timezone!==null?a.timepicker.timezoneOffsetNumber(b._defaults.timezone):(new Date).getTimezoneOffset()*-1;b.hour=b._defaults.hour<b._defaults.hourMin?b._defaults.hourMin:b._defaults.hour>b._defaults.hourMax?b._defaults.hourMax:b._defaults.hour;b.minute=b._defaults.minute<b._defaults.minuteMin?b._defaults.minuteMin:b._defaults.minute>b._defaults.minuteMax?b._defaults.minuteMax:b._defaults.minute;b.second=b._defaults.second<b._defaults.secondMin?b._defaults.secondMin:b._defaults.second>b._defaults.secondMax?b._defaults.secondMax:b._defaults.second;b.millisec=b._defaults.millisec<b._defaults.millisecMin?b._defaults.millisecMin:b._defaults.millisec>b._defaults.millisecMax?b._defaults.millisecMax:b._defaults.millisec;b.microsec=b._defaults.microsec<b._defaults.microsecMin?b._defaults.microsecMin:b._defaults.microsec>b._defaults.microsecMax?b._defaults.microsecMax:b._defaults.microsec;b.ampm="";b.$input=c;if(b._defaults.altField)b.$altInput=a(b._defaults.altField).css({cursor:"pointer"}).focus(function(){c.trigger("focus")});if(b._defaults.minDate===0||b._defaults.minDateTime===0)b._defaults.minDate=new Date;if(b._defaults.maxDate===0||b._defaults.maxDateTime===0)b._defaults.maxDate=new Date;if(b._defaults.minDate!==undefined&&b._defaults.minDate instanceof Date)b._defaults.minDateTime=new Date(b._defaults.minDate.getTime());if(b._defaults.minDateTime!==undefined&&b._defaults.minDateTime instanceof Date)b._defaults.minDate=new Date(b._defaults.minDateTime.getTime());if(b._defaults.maxDate!==undefined&&b._defaults.maxDate instanceof Date)b._defaults.maxDateTime=new Date(b._defaults.maxDate.getTime());if(b._defaults.maxDateTime!==undefined&&b._defaults.maxDateTime instanceof Date)b._defaults.maxDate=new Date(b._defaults.maxDateTime.getTime());b.$input.bind("focus",function(){b._onFocus()});return b},_addTimePicker:function(a){var b=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(b);this._limitMinMaxDateTime(a,false);this._injectTimePicker()},_parseTime:function(b,g){if(!this.inst)this.inst=a.datepicker._getInst(this.$input[0]);if(g||!this._defaults.timeOnly){var c=a.datepicker._get(this.inst,"dateFormat");try{var d=e(c,this._defaults.timeFormat,b,a.datepicker._getFormatConfig(this.inst),this._defaults);if(!d.timeObj)return false;a.extend(this,d.timeObj)}catch(h){a.timepicker.log("Error parsing the date/time string: "+h+"\ndate/time string = "+b+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+c);return false}return true}else{var f=a.datepicker.parseTime(this._defaults.timeFormat,b,this._defaults);if(!f)return false;a.extend(this,f);return true}},_injectTimePicker:function(){var o=this.inst.dpDiv,d=this.inst.settings,e=this,c="",h="",l=null,m={},j={},n=null,i=0,p=0;if(o.find("div.ui-timepicker-div").length===0&&d.showTimepicker){var k=' style="display:none;"',g='<div class="ui-timepicker-div'+(d.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(d.showTime?"":k)+">"+d.timeText+'</dt><dd class="ui_tpicker_time"'+(d.showTime?"":k)+"></dd>";for(i=0,p=this.units.length;i<p;i++){c=this.units[i];h=c.substr(0,1).toUpperCase()+c.substr(1);l=d["show"+h]!==null?d["show"+h]:this.support[c];m[c]=parseInt(d[c+"Max"]-(d[c+"Max"]-d[c+"Min"])%d["step"+h],10);j[c]=0;g+='<dt class="ui_tpicker_'+c+'_label"'+(l?"":k)+">"+d[c+"Text"]+'</dt><dd class="ui_tpicker_'+c+'"><div class="ui_tpicker_'+c+'_slider"'+(l?"":k)+"></div>";if(l&&d[c+"Grid"]>0){g+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';if(c==="hour")for(var s=d[c+"Min"];s<=m[c];s+=parseInt(d[c+"Grid"],10)){j[c]++;var y=a.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:s},d);g+='<td data-for="'+c+'">'+y+"</td>"}else for(var q=d[c+"Min"];q<=m[c];q+=parseInt(d[c+"Grid"],10)){j[c]++;g+='<td data-for="'+c+'">'+(q<10?"0":"")+q+"</td>"}g+="</tr></table></div>"}g+="</dd>"}var v=d.showTimezone!==null?d.showTimezone:this.support.timezone;g+='<dt class="ui_tpicker_timezone_label"'+(v?"":k)+">"+d.timezoneText+"</dt>";g+='<dd class="ui_tpicker_timezone" '+(v?"":k)+"></dd>";g+="</dl></div>";var f=a(g);if(d.timeOnly===true){f.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+d.timeOnlyTitle+"</div></div>");o.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()}for(i=0,p=e.units.length;i<p;i++){c=e.units[i];h=c.substr(0,1).toUpperCase()+c.substr(1);l=d["show"+h]!==null?d["show"+h]:this.support[c];e[c+"_slider"]=e.control.create(e,f.find(".ui_tpicker_"+c+"_slider"),c,e[c],d[c+"Min"],m[c],d["step"+h]);if(l&&d[c+"Grid"]>0){n=100*j[c]*d[c+"Grid"]/(m[c]-d[c+"Min"]);f.find(".ui_tpicker_"+c+" table").css({width:n+"%",marginLeft:d.isRTL?"0":n/(-2*j[c])+"%",marginRight:d.isRTL?n/(-2*j[c])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(){var d=a(this),h=d.html(),b=parseInt(h.replace(/[^0-9]/g),10),f=h.replace(/[^apm]/ig),g=d.data("for");if(g==="hour")if(f.indexOf("p")!==-1&&b<12)b+=12;else if(f.indexOf("a")!==-1&&b===12)b=0;e.control.value(e,e[g+"_slider"],c,b);e._onTimeChange();e._onSelectHandler()}).css({cursor:"pointer",width:100/j[c]+"%",textAlign:"center",overflow:"hidden"})}}this.timezone_select=f.find(".ui_tpicker_timezone").append("<select></select>").find("select");a.fn.append.apply(this.timezone_select,a.map(d.timezoneList,function(b){return a("<option />").val(typeof b==="object"?b.value:b).text(typeof b==="object"?b.label:b)}));if(typeof this.timezone!=="undefined"&&this.timezone!==null&&this.timezone!==""){var w=(new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12)).getTimezoneOffset()*-1;if(w===this.timezone)b(e);else this.timezone_select.val(this.timezone)}else if(typeof this.hour!=="undefined"&&this.hour!==null&&this.hour!=="")this.timezone_select.val(d.timezone);else b(e);this.timezone_select.change(function(){e._onTimeChange();e._onSelectHandler()});var u=o.find(".ui-datepicker-buttonpane");if(u.length)u.before(f);else o.append(f);this.$timeObj=f.find(".ui_tpicker_time");if(this.inst!==null){var x=this.timeDefined;this._onTimeChange();this.timeDefined=x}if(this._defaults.addSliderAccess){var t=this._defaults.sliderAccessArgs,r=this._defaults.isRTL;t.isRTL=r;setTimeout(function(){if(f.find(".ui-slider-access").length===0){f.find(".ui-slider:visible").sliderAccess(t);var b=f.find(".ui-slider-access:eq(0)").outerWidth(true);b&&f.find("table:visible").each(function(){var c=a(this),e=c.outerWidth(),h=c.css(r?"marginRight":"marginLeft").toString().replace("%",""),d=e-b,g=h*d/e+"%",f={width:d,marginRight:0,marginLeft:0};f[r?"marginRight":"marginLeft"]=g;c.css(f)})}},10)}e._limitMinMaxDateTime(this.inst,true)}},_limitMinMaxDateTime:function(b,g){var c=this._defaults,f=new Date(b.selectedYear,b.selectedMonth,b.selectedDay);if(!this._defaults.showTimepicker)return;if(a.datepicker._get(b,"minDateTime")!==null&&a.datepicker._get(b,"minDateTime")!==undefined&&f){var e=a.datepicker._get(b,"minDateTime"),i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null||this.microsecMinOriginal===null){this.hourMinOriginal=c.hourMin;this.minuteMinOriginal=c.minuteMin;this.secondMinOriginal=c.secondMin;this.millisecMinOriginal=c.millisecMin;this.microsecMinOriginal=c.microsecMin}if(b.settings.timeOnly||i.getTime()===f.getTime()){this._defaults.hourMin=e.getHours();if(this.hour<=this._defaults.hourMin){this.hour=this._defaults.hourMin;this._defaults.minuteMin=e.getMinutes();if(this.minute<=this._defaults.minuteMin){this.minute=this._defaults.minuteMin;this._defaults.secondMin=e.getSeconds();if(this.second<=this._defaults.secondMin){this.second=this._defaults.secondMin;this._defaults.millisecMin=e.getMilliseconds();if(this.millisec<=this._defaults.millisecMin){this.millisec=this._defaults.millisecMin;this._defaults.microsecMin=e.getMicroseconds()}else{if(this.microsec<this._defaults.microsecMin)this.microsec=this._defaults.microsecMin;this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}else{this._defaults.hourMin=this.hourMinOriginal;this._defaults.minuteMin=this.minuteMinOriginal;this._defaults.secondMin=this.secondMinOriginal;this._defaults.millisecMin=this.millisecMinOriginal;this._defaults.microsecMin=this.microsecMinOriginal}}if(a.datepicker._get(b,"maxDateTime")!==null&&a.datepicker._get(b,"maxDateTime")!==undefined&&f){var d=a.datepicker._get(b,"maxDateTime"),h=new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null||this.millisecMaxOriginal===null){this.hourMaxOriginal=c.hourMax;this.minuteMaxOriginal=c.minuteMax;this.secondMaxOriginal=c.secondMax;this.millisecMaxOriginal=c.millisecMax;this.microsecMaxOriginal=c.microsecMax}if(b.settings.timeOnly||h.getTime()===f.getTime()){this._defaults.hourMax=d.getHours();if(this.hour>=this._defaults.hourMax){this.hour=this._defaults.hourMax;this._defaults.minuteMax=d.getMinutes();if(this.minute>=this._defaults.minuteMax){this.minute=this._defaults.minuteMax;this._defaults.secondMax=d.getSeconds();if(this.second>=this._defaults.secondMax){this.second=this._defaults.secondMax;this._defaults.millisecMax=d.getMilliseconds();if(this.millisec>=this._defaults.millisecMax){this.millisec=this._defaults.millisecMax;this._defaults.microsecMax=d.getMicroseconds()}else{if(this.microsec>this._defaults.microsecMax)this.microsec=this._defaults.microsecMax;this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}else{this._defaults.hourMax=this.hourMaxOriginal;this._defaults.minuteMax=this.minuteMaxOriginal;this._defaults.secondMax=this.secondMaxOriginal;this._defaults.millisecMax=this.millisecMaxOriginal;this._defaults.microsecMax=this.microsecMaxOriginal}}if(g!==undefined&&g===true){var l=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),m=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),n=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),k=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10),j=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10);if(this.hour_slider){this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:l});this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)}if(this.minute_slider){this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:m});this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)}if(this.second_slider){this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:n});this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)}if(this.millisec_slider){this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:k});this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec)}if(this.microsec_slider){this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:j});this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec)}}},_onTimeChange:function(){if(!this._defaults.showTimepicker)return;var b=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):false,f=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):false,g=this.second_slider?this.control.value(this,this.second_slider,"second"):false,e=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):false,d=this.microsec_slider?this.control.value(this,this.microsec_slider,"microsec"):false,h=this.timezone_select?this.timezone_select.val():false,c=this._defaults,i=c.pickerTimeFormat||c.timeFormat,j=c.pickerTimeSuffix||c.timeSuffix;if(typeof b==="object")b=false;if(typeof f==="object")f=false;if(typeof g==="object")g=false;if(typeof e==="object")e=false;if(typeof d==="object")d=false;if(typeof h==="object")h=false;if(b!==false)b=parseInt(b,10);if(f!==false)f=parseInt(f,10);if(g!==false)g=parseInt(g,10);if(e!==false)e=parseInt(e,10);if(d!==false)d=parseInt(d,10);var l=c[b<12?"amNames":"pmNames"][0],k=b!==this.hour||f!==this.minute||g!==this.second||e!==this.millisec||d!==this.microsec||this.ampm.length>0&&b<12!==(a.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||this.timezone!==null&&h!==this.timezone;if(k){if(b!==false)this.hour=b;if(f!==false)this.minute=f;if(g!==false)this.second=g;if(e!==false)this.millisec=e;if(d!==false)this.microsec=d;if(h!==false)this.timezone=h;if(!this.inst)this.inst=a.datepicker._getInst(this.$input[0]);this._limitMinMaxDateTime(this.inst,true)}if(this.support.ampm)this.ampm=l;this.formattedTime=a.datepicker.formatTime(c.timeFormat,this,c);if(this.$timeObj)if(i===c.timeFormat)this.$timeObj.text(this.formattedTime+j);else this.$timeObj.text(a.datepicker.formatTime(i,this,c)+j);this.timeDefined=true;k&&this._updateDateTime()},_onSelectHandler:function(){var a=this._defaults.onSelect||this.inst.settings.onSelect,b=this.$input?this.$input[0]:null;a&&b&&a.apply(b,[this.formattedDateTime,this])},_updateDateTime:function(b){b=this.inst||b;var k=b.currentYear>0?new Date(b.currentYear,b.currentMonth,b.currentDay):new Date(b.selectedYear,b.selectedMonth,b.selectedDay),e=a.datepicker._daylightSavingAdjust(k),j=a.datepicker._get(b,"dateFormat"),g=a.datepicker._getFormatConfig(b),h=e!==null&&this.timeDefined;this.formattedDate=a.datepicker.formatDate(j,e===null?new Date:e,g);var d=this.formattedDate;if(b.lastVa===""){b.currentYear=b.selectedYear;b.currentMonth=b.selectedMonth;b.currentDay=b.selectedDay}if(this._defaults.timeOnly===true)d=this.formattedTime;else if(this._defaults.timeOnly!==true&&(this._defaults.alwaysSetTime||h))d+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix;this.formattedDateTime=d;if(!this._defaults.showTimepicker)this.$input.val(this.formattedDate);else if(this.$altInput&&this._defaults.timeOnly===false&&this._defaults.altFieldTimeOnly===true){this.$altInput.val(this.formattedTime);this.$input.val(this.formattedDate)}else if(this.$altInput){this.$input.val(d);var c="",i=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,f=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;if(!this._defaults.timeOnly){if(this._defaults.altFormat)c=a.datepicker.formatDate(this._defaults.altFormat,e===null?new Date:e,g);else c=this.formattedDate;if(c)c+=i}if(this._defaults.altTimeFormat)c+=a.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+f;else c+=this.formattedTime+f;this.$altInput.val(c)}else this.$input.val(d);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var b=a.datepicker._getInst(this.$input.get(0)),c=a.datepicker._get(b,"timepicker");if(c)if(c._defaults.timeOnly&&b.input.val()!==b.lastVal)try{a.datepicker._updateDatepicker(b)}catch(d){a.timepicker.log(d)}}},_controls:{slider:{create:function(b,i,h,f,e,d,g){var c=b._defaults.isRTL;return i.prop("slide",null).slider({orientation:"horizontal",value:c?f*-1:f,min:c?d*-1:e,max:c?e*-1:d,step:g,slide:function(e,d){b.control.value(b,a(this),h,c?d.value*-1:d.value);b._onTimeChange()},stop:function(){b._onSelectHandler()}})},options:function(f,b,g,a,c){if(f._defaults.isRTL){if(typeof a==="string")return a==="min"||a==="max"?c!==undefined?b.slider(a,c*-1):Math.abs(b.slider(a)):b.slider(a);var e=a.min,d=a.max;a.min=a.max=null;if(e!==undefined)a.max=e*-1;if(d!==undefined)a.min=d*-1;return b.slider(a)}return typeof a==="string"&&c!==undefined?b.slider(a,c):b.slider(a)},value:function(c,a,d,b){return c._defaults.isRTL?b!==undefined?a.slider("value",b*-1):Math.abs(a.slider("value")):b!==undefined?a.slider("value",b):a.slider("value")}},select:{create:function(d,f,e,k,i,h,g){for(var c='<select class="ui-timepicker-select" data-unit="'+e+'" data-min="'+i+'" data-max="'+h+'" data-step="'+g+'">',j=d._defaults.pickerTimeFormat||d._defaults.timeFormat,b=i;b<=h;b+=g){c+='<option value="'+b+'"'+(b===k?" selected":"")+">";if(e==="hour")c+=a.datepicker.formatTime(a.trim(j.replace(/[^ht ]/ig,"")),{hour:b},d._defaults);else if(e==="millisec"||e==="microsec"||b>=10)c+=b;else c+="0"+b.toString();c+="</option>"}c+="</select>";f.children("select").remove();a(c).appendTo(f).change(function(){d._onTimeChange();d._onSelectHandler()});return f},options:function(d,e,g,c,f){var b={},a=e.children("select");if(typeof c==="string"){if(f===undefined)return a.data(c);b[c]=f}else b=c;return d.control.create(d,e,a.data("unit"),a.val(),b.min||a.data("min"),b.max||a.data("max"),b.step||a.data("step"))},value:function(d,c,e,a){var b=c.children("select");return a!==undefined?b.val(a):b.val()}}}});a.fn.extend({timepicker:function(b){b=b||{};var c=Array.prototype.slice.call(arguments);if(typeof b==="object")c[0]=a.extend(b,{timeOnly:true});return a(this).each(function(){a.fn.datetimepicker.apply(a(this),c)})},datetimepicker:function(b){b=b||{};var c=arguments;return typeof b==="string"?b==="getDate"?a.fn.datepicker.apply(a(this[0]),c):this.each(function(){var b=a(this);b.datepicker.apply(b,c)}):this.each(function(){var c=a(this);c.datepicker(a.timepicker._newInst(c,b)._defaults)})}});a.datepicker.parseDateTime=function(g,h,c,d,f){var a=e(g,h,c,d,f);if(a.timeObj){var b=a.timeObj;a.date.setHours(b.hour,b.minute,b.second,b.millisec);a.date.setMicroseconds(b.microsec)}return a.date};a.datepicker.parseTime=function(d,e,h){var b=c(c({},a.timepicker._defaults),h||{}),i=d.replace(/\'.*?\'/g,"").indexOf("Z")!==-1,f=function(g,k,f){var i=function(c,d){var b=[];c&&a.merge(b,c);d&&a.merge(b,d);b=a.map(b,function(a){return a.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")});return"("+b.join("|")+")?"},h=function(d){var b=d.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),c={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1};if(b)for(var a=0;a<b.length;a++)if(c[b[a].toString().charAt(0)]===-1)c[b[a].toString().charAt(0)]=a+1;return c},j="^"+g.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(b){var a=b.length;switch(b.charAt(0).toLowerCase()){case"h":return a===1?"(\\d?\\d)":"(\\d{"+a+"})";case"m":return a===1?"(\\d?\\d)":"(\\d{"+a+"})";case"s":return a===1?"(\\d?\\d)":"(\\d{"+a+"})";case"l":return"(\\d?\\d?\\d)";case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return i(f.amNames,f.pmNames);default:return"("+b.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(a){return"\\"+a})+")?"}}).replace(/\s/g,"\\s?")+f.timeSuffix+"$",b=h(g),e="",c;c=k.match(new RegExp(j,"i"));var d={hour:0,minute:0,second:0,millisec:0,microsec:0};if(c){if(b.t!==-1)if(c[b.t]===undefined||c[b.t].length===0){e="";d.ampm=""}else{e=a.inArray(c[b.t].toUpperCase(),f.amNames)!==-1?"AM":"PM";d.ampm=f[e==="AM"?"amNames":"pmNames"][0]}if(b.h!==-1)if(e==="AM"&&c[b.h]==="12")d.hour=0;else if(e==="PM"&&c[b.h]!=="12")d.hour=parseInt(c[b.h],10)+12;else d.hour=Number(c[b.h]);if(b.m!==-1)d.minute=Number(c[b.m]);if(b.s!==-1)d.second=Number(c[b.s]);if(b.l!==-1)d.millisec=Number(c[b.l]);if(b.c!==-1)d.microsec=Number(c[b.c]);if(b.z!==-1&&c[b.z]!==undefined)d.timezone=a.timepicker.timezoneOffsetNumber(c[b.z]);return d}return false},g=function(d,c,e){try{var b=new Date("2012-01-01 "+c);if(isNaN(b.getTime())){b=new Date("2012-01-01T"+c);if(isNaN(b.getTime())){b=new Date("01/01/2012 "+c);if(isNaN(b.getTime()))throw"Unable to parse time with native Date: "+c;}}return{hour:b.getHours(),minute:b.getMinutes(),second:b.getSeconds(),millisec:b.getMilliseconds(),microsec:b.getMicroseconds(),timezone:b.getTimezoneOffset()*-1}}catch(h){try{return f(d,c,e)}catch(g){a.timepicker.log("Unable to parse \ntimeString: "+c+"\ntimeFormat: "+d)}}return false};return typeof b.parse==="function"?b.parse(d,e,b):b.parse==="loose"?g(d,e,b):f(d,e,b)};a.datepicker.formatTime=function(h,b,c){c=c||{};c=a.extend({},a.timepicker._defaults,c);b=a.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},b);var g=h,d=c.amNames[0],e=parseInt(b.hour,10);if(e>11)d=c.pmNames[0];g=g.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(g){switch(g){case"HH":return("0"+e).slice(-2);case"H":return e;case"hh":return("0"+f(e)).slice(-2);case"h":return f(e);case"mm":return("0"+b.minute).slice(-2);case"m":return b.minute;case"ss":return("0"+b.second).slice(-2);case"s":return b.second;case"l":return("00"+b.millisec).slice(-3);case"c":return("00"+b.microsec).slice(-3);case"z":return a.timepicker.timezoneOffsetString(b.timezone===null?c.timezone:b.timezone,false);case"Z":return a.timepicker.timezoneOffsetString(b.timezone===null?c.timezone:b.timezone,true);case"T":return d.charAt(0).toUpperCase();case"TT":return d.toUpperCase();case"t":return d.charAt(0).toLowerCase();case"tt":return d.toLowerCase();default:return g.replace(/'/g,"")}});return g};a.datepicker._base_selectDate=a.datepicker._selectDate;a.datepicker._selectDate=function(c,d){var b=this._getInst(a(c)[0]),e=this._get(b,"timepicker");if(e){e._limitMinMaxDateTime(b,true);b.inline=b.stay_open=true;this._base_selectDate(c,d);b.inline=b.stay_open=false;this._notifyChange(b);this._updateDatepicker(b)}else this._base_selectDate(c,d)};a.datepicker._base_updateDatepicker=a.datepicker._updateDatepicker;a.datepicker._updateDatepicker=function(b){var d=b.input[0];if(a.datepicker._curInst&&a.datepicker._curInst!==b&&a.datepicker._datepickerShowing&&a.datepicker._lastInput!==d)return;if(typeof b.stay_open!=="boolean"||b.stay_open===false){this._base_updateDatepicker(b);var c=this._get(b,"timepicker");c&&c._addTimePicker(b)}};a.datepicker._base_doKeyPress=a.datepicker._doKeyPress;a.datepicker._doKeyPress=function(c){var e=a.datepicker._getInst(c.target),b=a.datepicker._get(e,"timepicker");if(b)if(a.datepicker._get(e,"constrainInput")){var d=b.support.ampm,i=b._defaults.showTimezone!==null?b._defaults.showTimezone:b.support.timezone,f=a.datepicker._possibleChars(a.datepicker._get(e,"dateFormat")),h=b._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,d?"APM":"").replace(/Tt/g,d?"AaPpMm":"").replace(/tT/g,d?"AaPpMm":"").replace(/T/g,d?"AP":"").replace(/tt/g,d?"apm":"").replace(/t/g,d?"ap":"")+" "+b._defaults.separator+b._defaults.timeSuffix+(i?b._defaults.timezoneList.join(""):"")+b._defaults.amNames.join("")+b._defaults.pmNames.join("")+f,g=String.fromCharCode(c.charCode===undefined?c.keyCode:c.charCode);return c.ctrlKey||(g<" "||!f||h.indexOf(g)>-1)}return a.datepicker._base_doKeyPress(c)};a.datepicker._base_updateAlternate=a.datepicker._updateAlternate;a.datepicker._updateAlternate=function(d){var b=this._get(d,"timepicker");if(b){var f=b._defaults.altField;if(f){var k=b._defaults.altFormat||b._defaults.dateFormat,g=this._getDate(d),j=a.datepicker._getFormatConfig(d),c="",e=b._defaults.altSeparator?b._defaults.altSeparator:b._defaults.separator,i=b._defaults.altTimeSuffix?b._defaults.altTimeSuffix:b._defaults.timeSuffix,h=b._defaults.altTimeFormat!==null?b._defaults.altTimeFormat:b._defaults.timeFormat;c+=a.datepicker.formatTime(h,b,b._defaults)+i;if(!b._defaults.timeOnly&&!b._defaults.altFieldTimeOnly&&g!==null)if(b._defaults.altFormat)c=a.datepicker.formatDate(b._defaults.altFormat,g,j)+e+c;else c=b.formattedDate+e+c;a(f).val(c)}}else a.datepicker._base_updateAlternate(d)};a.datepicker._base_doKeyUp=a.datepicker._doKeyUp;a.datepicker._doKeyUp=function(d){var b=a.datepicker._getInst(d.target),c=a.datepicker._get(b,"timepicker");if(c)if(c._defaults.timeOnly&&b.input.val()!==b.lastVal)try{a.datepicker._updateDatepicker(b)}catch(e){a.timepicker.log(e)}return a.datepicker._base_doKeyUp(d)};a.datepicker._base_gotoToday=a.datepicker._gotoToday;a.datepicker._gotoToday=function(d){var c=this._getInst(a(d)[0]),f=c.dpDiv;this._base_gotoToday(d);var e=this._get(c,"timepicker");b(e);var g=new Date;this._setTime(c,g);a(".ui-datepicker-today",f).click()};a.datepicker._disableTimepickerDatepicker=function(d){var b=this._getInst(d);if(!b)return;var c=this._get(b,"timepicker");a(d).datepicker("getDate");if(c){b.settings.showTimepicker=false;c._defaults.showTimepicker=false;c._updateDateTime(b)}};a.datepicker._enableTimepickerDatepicker=function(d){var b=this._getInst(d);if(!b)return;var c=this._get(b,"timepicker");a(d).datepicker("getDate");if(c){b.settings.showTimepicker=true;c._defaults.showTimepicker=true;c._addTimePicker(b);c._updateDateTime(b)}};a.datepicker._setTime=function(d,b){var a=this._get(d,"timepicker");if(a){var c=a._defaults;a.hour=b?b.getHours():c.hour;a.minute=b?b.getMinutes():c.minute;a.second=b?b.getSeconds():c.second;a.millisec=b?b.getMilliseconds():c.millisec;a.microsec=b?b.getMicroseconds():c.microsec;a._limitMinMaxDateTime(d,true);a._onTimeChange();a._updateDateTime(d)}};a.datepicker._setTimeDatepicker=function(f,c,e){var d=this._getInst(f);if(!d)return;var b=this._get(d,"timepicker");if(b){this._setDateFromField(d);var a;if(c){if(typeof c==="string"){b._parseTime(c,e);a=new Date;a.setHours(b.hour,b.minute,b.second,b.millisec);a.setMicroseconds(b.microsec)}else{a=new Date(c.getTime());a.setMicroseconds(c.getMicroseconds())}if(a.toString()==="Invalid Date")a=undefined;this._setTime(d,a)}}};a.datepicker._base_setDateDatepicker=a.datepicker._setDateDatepicker;a.datepicker._setDateDatepicker=function(f,b){var e=this._getInst(f);if(!e)return;if(typeof b==="string"){b=new Date(b);!b.getTime()&&a.timepicker.log("Error creating Date object from string.")}var d=this._get(e,"timepicker"),c;if(b instanceof Date){c=new Date(b.getTime());c.setMicroseconds(b.getMicroseconds())}else c=b;if(d){if(!d.support.timezone&&d._defaults.timezone===null)d.timezone=c.getTimezoneOffset()*-1;b=a.timepicker.timezoneAdjust(b,d.timezone);c=a.timepicker.timezoneAdjust(c,d.timezone)}this._updateDatepicker(e);this._base_setDateDatepicker.apply(this,arguments);this._setTimeDatepicker(f,c,true)};a.datepicker._base_getDateDatepicker=a.datepicker._getDateDatepicker;a.datepicker._getDateDatepicker=function(e,f){var d=this._getInst(e);if(!d)return;var b=this._get(d,"timepicker");if(b){d.lastVal===undefined&&this._setDateFromField(d,f);var c=this._getDate(d);if(c&&b._parseTime(a(e).val(),b.timeOnly)){c.setHours(b.hour,b.minute,b.second,b.millisec);c.setMicroseconds(b.microsec);if(b.timezone!=null){if(!b.support.timezone&&b._defaults.timezone===null)b.timezone=c.getTimezoneOffset()*-1;c=a.timepicker.timezoneAdjust(c,b.timezone)}}return c}return this._base_getDateDatepicker(e,f)};a.datepicker._base_parseDate=a.datepicker.parseDate;a.datepicker.parseDate=function(c,b,e){var d;try{d=this._base_parseDate(c,b,e)}catch(f){if(f.indexOf(":")>=0){d=this._base_parseDate(c,b.substring(0,b.length-(f.length-f.indexOf(":")-2)),e);a.timepicker.log("Error parsing the date string: "+f+"\ndate string = "+b+"\ndate format = "+c)}else throw f;}return d};a.datepicker._base_formatDate=a.datepicker._formatDate;a.datepicker._formatDate=function(b){var a=this._get(b,"timepicker");if(a){a._updateDateTime(b);return a.$input.val()}return this._base_formatDate(b)};a.datepicker._base_optionDatepicker=a.datepicker._optionDatepicker;a.datepicker._optionDatepicker=function(m,b,h){var n=this._getInst(m),f;if(!n)return null;var g=this._get(n,"timepicker");if(g){var e=null,d=null,l=null,j=g._defaults.evnts,k={},c;if(typeof b==="string"){if(b==="minDate"||b==="minDateTime")e=h;else if(b==="maxDate"||b==="maxDateTime")d=h;else if(b==="onSelect")l=h;else if(j.hasOwnProperty(b)){if(typeof h==="undefined")return j[b];k[b]=h;f={}}}else if(typeof b==="object"){if(b.minDate)e=b.minDate;else if(b.minDateTime)e=b.minDateTime;else if(b.maxDate)d=b.maxDate;else if(b.maxDateTime)d=b.maxDateTime;for(c in j)if(j.hasOwnProperty(c)&&b[c])k[c]=b[c]}for(c in k)if(k.hasOwnProperty(c)){j[c]=k[c];if(!f)f=a.extend({},b);delete f[c]}if(f&&i(f))return;if(e){if(e===0)e=new Date;else e=new Date(e);g._defaults.minDate=e;g._defaults.minDateTime=e}else if(d){if(d===0)d=new Date;else d=new Date(d);g._defaults.maxDate=d;g._defaults.maxDateTime=d}else if(l)g._defaults.onSelect=l}return h===undefined?this._base_optionDatepicker.call(a.datepicker,m,b):this._base_optionDatepicker.call(a.datepicker,m,f||b,h)};var i=function(b){var a;for(a in b)if(b.hasOwnProperty(a))return false;return true},c=function(d,b){a.extend(d,b);for(var c in b)if(b[c]===null||b[c]===undefined)d[c]=b[c];return d},h=function(c){var b=c.replace(/'.*?'/g,"").toLowerCase(),a=function(a,b){return a.indexOf(b)!==-1?true:false};return{hour:a(b,"h"),minute:a(b,"m"),second:a(b,"s"),millisec:a(b,"l"),microsec:a(b,"c"),timezone:a(b,"z"),ampm:a(b,"t")&&a(c,"h"),iso8601:a(c,"Z")}},f=function(a){a%=12;if(a===0)a=12;return String(a)},d=function(c,b){return c&&c[b]?c[b]:a.timepicker._defaults[b]},j=function(c,f){var a=d(f,"separator"),i=d(f,"timeFormat"),h=i.split(a),e=h.length,b=c.split(a),g=b.length;return g>1?{dateString:b.splice(0,g-e).join(a),timeString:b.splice(0,e).join(a)}:{dateString:c,timeString:""}},e=function(h,i,f,g,e){var d,b,c;b=j(f,e);d=a.datepicker._base_parseDate(h,b.dateString,g);if(b.timeString==="")return{date:d};c=a.datepicker.parseTime(i,b.timeString,e);if(!c)throw"Wrong time format";return{date:d,timeObj:c}},b=function(a,b){if(a&&a.timezone_select){var c=b||new Date;a.timezone_select.val(-c.getTimezoneOffset())}};a.timepicker=new g;a.timepicker.timezoneOffsetString=function(a,e){if(isNaN(a)||a>840||a<-720)return a;var b=a,c=b%60,f=(b-c)/60,g=e?":":"",d=(b>=0?"+":"-")+("0"+Math.abs(f)).slice(-2)+g+("0"+Math.abs(c)).slice(-2);return d==="+00:00"?"Z":d};a.timepicker.timezoneOffsetNumber=function(b){var a=b.toString().replace(":","");return a.toUpperCase()==="Z"?0:!/^(\-|\+)\d{4}$/.test(a)?b:(a.substr(0,1)==="-"?-1:1)*(parseInt(a.substr(1,2),10)*60+parseInt(a.substr(3,2),10))};a.timepicker.timezoneAdjust=function(b,d){var c=a.timepicker.timezoneOffsetNumber(d);!isNaN(c)&&b.setMinutes(b.getMinutes()+-b.getTimezoneOffset()-c);return b};a.timepicker.timeRange=function(b,c,d){return a.timepicker.handleRange("timepicker",b,c,d)};a.timepicker.datetimeRange=function(b,c,d){a.timepicker.handleRange("datetimepicker",b,c,d)};a.timepicker.dateRange=function(b,c,d){a.timepicker.handleRange("datepicker",b,c,d)};a.timepicker.handleRange=function(d,e,c,b){b=a.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},b);function g(j,k){var g=e[d]("getDate"),h=c[d]("getDate"),i=j[d]("getDate");if(g!==null){var f=new Date(g.getTime()),a=new Date(g.getTime());f.setMilliseconds(f.getMilliseconds()+b.minInterval);a.setMilliseconds(a.getMilliseconds()+b.maxInterval);if(b.minInterval>0&&f>h)c[d]("setDate",f);else if(b.maxInterval>0&&a<h)c[d]("setDate",a);else g>h&&k[d]("setDate",i)}}function f(c,f,e){if(!c.val())return;var a=c[d].call(c,"getDate");if(a!==null&&b.minInterval>0){e==="minDate"&&a.setMilliseconds(a.getMilliseconds()+b.minInterval);e==="maxDate"&&a.setMilliseconds(a.getMilliseconds()-b.minInterval)}a.getTime&&f[d].call(f,"option",e,a)}a.fn[d].call(e,a.extend({onClose:function(){g(a(this),c)},onSelect:function(){f(a(this),c,"minDate")}},b,b.start));a.fn[d].call(c,a.extend({onClose:function(){g(a(this),e)},onSelect:function(){f(a(this),e,"maxDate")}},b,b.end));g(e,c);f(e,c,"minDate");f(c,e,"maxDate");return a([e.get(0),c.get(0)])};a.timepicker.log=function(a){window.console&&window.console.log(a)};a.timepicker._util={_extendRemove:c,_isEmptyObject:i,_convert24to12:f,_detectSupport:h,_selectLocalTimezone:b,_computeEffectiveSetting:d,_splitDateTime:j,_parseDateTimeInternal:e};if(!Date.prototype.getMicroseconds){Date.prototype.microseconds=0;Date.prototype.getMicroseconds=function(){return this.microseconds};Date.prototype.setMicroseconds=function(a){this.setMilliseconds(this.getMilliseconds()+Math.floor(a/1e3));this.microseconds=a%1e3;return this}}a.timepicker.version="1.4"})(jQuery);