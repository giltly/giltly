var json2html={transform:function(b,d,e){var c={events:[],html:""},a={events:false};a=json2html._extend(a,e);if(d!==undefined||b!==undefined){var f=typeof b==="string"?JSON.parse(b):b;c=json2html._transform(f,d,a)}return a.events?c:c.html},_extend:function(c,d){var b={};for(var a in c)b[a]=c[a];for(var a in d)b[a]=d[a];return b},_append:function(a,b){var c={html:"",event:[]};if(typeof a!=="undefined"&&typeof b!=="undefined"){c.html=a.html+b.html;c.events=a.events.concat(b.events)}return c},_isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},_transform:function(b,d,e){var a={events:[],html:""};if(json2html._isArray(b))for(var f=b.length,c=0;c<f;++c)a=json2html._append(a,json2html._apply(b[c],d,c,e));else if(typeof b==="object")a=json2html._append(a,json2html._apply(b,d,undefined,e));return a},_apply:function(d,a,f,h){var b={events:[],html:""};if(json2html._isArray(a))for(var o=a.length,l=0;l<o;++l)b=json2html._append(b,json2html._apply(d,a[l],f,h));else if(typeof a==="object")if(a.tag!==undefined){b.html+="<"+a.tag;var e={events:[],html:""},j;for(var c in a)switch(c){case"tag":break;case"children":if(json2html._isArray(a.children))e=json2html._append(e,json2html._apply(d,a.children,f,h));else if(typeof a.children==="function"){var g=a.children.call(d,d,f);if(typeof g==="object"){if(g.html!==undefined&&g.events!==undefined)e=json2html._append(e,g)}else if(typeof g==="string")e.html+=g}break;case"html":j=json2html._getValue(d,a,"html",f);break;default:var m=false;if(c.length>2)if(c.substring(0,2).toLowerCase()=="on"){if(h.events){var p={action:a[c],obj:d,data:h.eventData,index:f},n=json2html._guid();b.events[b.events.length]={id:n,type:c.substring(2),data:p};b.html+=" json2html-event-id-"+c.substring(2)+"='"+n+"'"}m=true}if(!m){var i=json2html._getValue(d,a,c,f);if(i!==undefined){var k;if(typeof i==="string")k='"'+i.replace(/"/g,"&quot;")+'"';else k=i;b.html+=" "+c+"="+k}}}b.html+=">";if(j)b.html+=j;b=json2html._append(b,e);b.html+="</"+a.tag+">"}return b},_guid:function(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return a()+a()+"-"+a()+a()+"-"+a()+a()},_getValue:function(b,f,h,g){var c="",a=f[h],d=typeof a;if(d==="function")return a.call(b,b,g);else if(d==="string"){var e=new json2html._tokenizer([/\$\{([^\}\{]+)\}/],function(a,c,d){return c?a.replace(d,function(i,h){for(var d=h.split("."),a=b,e="",g=d.length,c=0;c<g;++c)if(d[c].length>0){var f=a[d[c]];a=f;if(a===null||a===undefined)break}if(a!==null&&a!==undefined)e=a;return e}):a});c=e.parse(a).join("")}else c=a;return c},_tokenizer:function(a,b){if(!(this instanceof json2html._tokenizer))return new json2html._tokenizer(a,b);this.tokenizers=a.splice?a:[a];if(b)this.doBuild=b;this.parse=function(a){this.src=a;this.ended=false;this.tokens=[];do this.next();while(!this.ended);return this.tokens};this.build=function(a,b){a&&this.tokens.push(!this.doBuild?a:this.doBuild(a,b,this.tkn))};this.next=function(){var a=this,b;a.findMin();b=a.src.slice(0,a.min);a.build(b,false);a.src=a.src.slice(a.min).replace(a.tkn,function(b){a.build(b,true);return""});if(!a.src)a.ended=true};this.findMin=function(){var a=this,d=0,c,b;a.min=-1;a.tkn="";while((c=a.tokenizers[d++])!==undefined){b=a.src[c.test?"search":"indexOf"](c);if(b!=-1&&(a.min==-1||b<a.min)){a.tkn=c;a.min=b}}if(a.min==-1)a.min=a.src.length}}};