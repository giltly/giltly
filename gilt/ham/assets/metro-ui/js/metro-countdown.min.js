(function(a){a.widget("metro.countdown",{version:"1.0.0",options:{style:{background:"bg-dark",foreground:"fg-white",divider:"fg-dark"},blink:true,days:1,stoptimer:0,ontick:function(){},onstop:function(){}},wrappers:{},_interval:0,_create:function(){var c=this,b=this.element;a.each(["Days","Hours","Minutes","Seconds"],function(){a('<span class="count'+this+'">').html('<span class="digit-wrapper">                        <span class="digit">0</span>                    </span>                    <span class="digit-wrapper">                        <span class="digit">0</span>                    </span>').appendTo(b);this!="Seconds"&&b.append('<span class="divider"></span>')});this.wrappers=this.element.find(".digit-wrapper");if(b.data("blink")!=undefined)this.options.blink=b.data("blick");if(b.data("styleBackground")!=undefined)this.options.style.background=b.data("styleBackground");if(b.data("styleForeground")!=undefined)this.options.style.foreground=b.data("styleForeground");if(b.data("styleDivider")!=undefined)this.options.style.divider=b.data("styleDivider");this.options.style.background!="default"&&this.element.find(".digit").addClass(this.options.style.background);this.options.style.foreground!="default"&&this.element.find(".digit").addClass(this.options.style.foreground);this.options.style.divider!="default"&&this.element.find(".divider").addClass(this.options.style.divider);if(b.data("stoptimer")!=undefined)this.options.stoptimer=new Date(b.data("stoptimer"));if(this.options.stoptimer==0)this.options.stoptimer=(new Date).getTime()+this.options.days*24*60*60*1e3;setTimeout(function(){c.tick()},1e3)},_destroy:function(){},_setOption:function(b,a){this._super("_setOption",b,a)},tick:function(){var a=this;this._interval=setInterval(function(){var i=24*60*60,h=60*60,g=60,b,c,d,e,f;b=Math.floor((a.options.stoptimer-new Date)/1e3);if(b<0)b=0;c=Math.floor(b/i);a.updateDuo(0,1,c);b-=c*i;d=Math.floor(b/h);a.updateDuo(2,3,d);b-=d*h;e=Math.floor(b/g);a.updateDuo(4,5,e);b-=e*g;f=b;a.updateDuo(6,7,f);a.options.ontick(c,d,e,f);a.blinkDivider();if(c===0&&d===0&&e===0&&f===0){a.options.onstop();a.stopDigit();a._trigger("alarm");clearInterval(a._interval)}},1e3)},blinkDivider:function(){this.options.blink&&this.element.find(".divider").toggleClass("no-visible")},stopDigit:function(){this.wrappers.each(function(){a(this).children(".digit").addClass("stop")})},updateDuo:function(c,b,a){this.switchDigit(this.wrappers.eq(c),Math.floor(a/10)%10);this.switchDigit(this.wrappers.eq(b),a%10)},switchDigit:function(c,d){var e=c.find(".digit");if(e.is(":animated"))return false;if(c.data("digit")==d)return false;c.data("digit",d);var b=a("<span>",{"class":"digit",css:{top:"-2.1em",opacity:0},html:d});b.addClass(this.options.style.background);b.addClass(this.options.style.foreground);e.before(b).removeClass("static").animate({top:"2.5em"},"fast",function(){e.remove()});b.delay(100).animate({top:0,opacity:1},"fast");return true}})})(jQuery);$(function(){$("[data-role=countdown]").countdown()});